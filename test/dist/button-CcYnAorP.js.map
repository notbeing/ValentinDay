{"version":3,"file":"button-CcYnAorP.js","sources":["../src/helpers/sequentialDom.ts","../src/components/ripple.ts","../src/icons.ts","../src/iconsReverse.ts","../src/components/icon.ts","../src/components/button.ts"],"sourcesContent":["/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport {fastRaf} from './schedulers';\r\nimport deferredPromise, {CancellablePromise} from './cancellablePromise';\r\nimport {MOUNT_CLASS_TO} from '../config/debug';\r\nimport isInDOM from './dom/isInDOM';\r\n\r\nclass SequentialDom {\r\n  private promises: Partial<{\r\n    read: CancellablePromise<void>,\r\n    write: CancellablePromise<void>\r\n  }> = {};\r\n  private raf = fastRaf.bind(null);\r\n  private scheduled = false;\r\n\r\n  private do(kind: keyof SequentialDom['promises'], callback?: VoidFunction) {\r\n    let promise = this.promises[kind];\r\n    if(!promise) {\r\n      this.scheduleFlush();\r\n      promise = this.promises[kind] = deferredPromise<void>();\r\n    }\r\n\r\n    if(callback !== undefined) {\r\n      promise.then(() => callback());\r\n    }\r\n\r\n    return promise;\r\n  }\r\n\r\n  public measure(callback?: VoidFunction) {\r\n    return this.do('read', callback);\r\n  }\r\n\r\n  public mutate(callback?: VoidFunction) {\r\n    return this.do('write', callback);\r\n  }\r\n\r\n  /**\r\n   * Will fire instantly if element is not connected\r\n   * @param element\r\n   * @param callback\r\n   */\r\n  public mutateElement(element: HTMLElement, callback?: VoidFunction) {\r\n    const isConnected = isInDOM(element);\r\n    const promise = isConnected ? this.mutate() : Promise.resolve();\r\n\r\n    if(callback !== undefined) {\r\n      if(!isConnected) {\r\n        callback();\r\n      } else {\r\n        promise.then(() => callback());\r\n      }\r\n    }\r\n\r\n    return promise;\r\n  }\r\n\r\n  private scheduleFlush() {\r\n    if(!this.scheduled) {\r\n      this.scheduled = true;\r\n\r\n      this.raf(() => {\r\n        this.promises.read && this.promises.read.resolve();\r\n        this.promises.write && this.promises.write.resolve();\r\n\r\n        this.scheduled = false;\r\n        this.promises = {};\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nconst sequentialDom = new SequentialDom();\r\nMOUNT_CLASS_TO && (MOUNT_CLASS_TO.sequentialDom = sequentialDom);\r\nexport default sequentialDom;\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport findUpClassName from '../helpers/dom/findUpClassName';\r\nimport sequentialDom from '../helpers/sequentialDom';\r\nimport IS_TOUCH_SUPPORTED from '../environment/touchSupport';\r\nimport findUpAsChild from '../helpers/dom/findUpAsChild';\r\nimport {fastRaf} from '../helpers/schedulers';\r\nimport liteMode from '../helpers/liteMode';\r\n\r\nlet rippleClickId = 0;\r\nexport default function ripple(\r\n  elem: HTMLElement,\r\n  callback: (id: number) => Promise<boolean | void> = () => Promise.resolve(),\r\n  onEnd: (id: number) => void = null,\r\n  prepend = false,\r\n  attachListenerTo = elem\r\n) {\r\n  // return;\r\n  if(elem.querySelector('.c-ripple')) return;\r\n  elem.classList.add('rp');\r\n\r\n  const r = document.createElement('div');\r\n  r.classList.add('c-ripple');\r\n\r\n  const isSquare = elem.classList.contains('rp-square');\r\n  if(isSquare) {\r\n    r.classList.add('is-square');\r\n  }\r\n\r\n  elem[prepend ? 'prepend' : 'append'](r);\r\n\r\n  let handler: () => void;\r\n  // let animationEndPromise: Promise<number>;\r\n  const drawRipple = (clientX: number, clientY: number) => {\r\n    const startTime = Date.now();\r\n    const circle = document.createElement('div');\r\n\r\n    const clickId = rippleClickId++;\r\n\r\n    // console.log('ripple drawRipple');\r\n\r\n    // const auto = elem.classList.contains('row-sortable') && !elem.classList.contains('cant-sort');\r\n    const auto = false;\r\n    const duration = (auto ? .3 : +window.getComputedStyle(r).getPropertyValue('--ripple-duration').replace('s', '')) * 1000;\r\n    // console.log('ripple duration', duration);\r\n\r\n    const _handler = handler = () => {\r\n    // handler = () => animationEndPromise.then((duration) => {\r\n      // console.log('ripple animation was:', duration);\r\n\r\n      // const duration = isSquare || mediaSizes.isMobile ? 200 : 700;\r\n      // return;\r\n      const elapsedTime = Date.now() - startTime;\r\n      const cb = () => {\r\n        // console.log('ripple elapsedTime total pre-remove:', Date.now() - startTime);\r\n        sequentialDom.mutate(() => {\r\n          circle.remove();\r\n        });\r\n\r\n        onEnd?.(clickId);\r\n      };\r\n      if(elapsedTime < duration) {\r\n        const delay = Math.max(duration - elapsedTime, duration / 2);\r\n        setTimeout(() => circle.classList.add('hiding'), Math.max(delay - duration / 2, 0));\r\n\r\n        setTimeout(cb, delay);\r\n      } else {\r\n        circle.classList.add('hiding');\r\n        setTimeout(cb, duration / 2);\r\n      }\r\n\r\n      if(!IS_TOUCH_SUPPORTED) {\r\n        window.removeEventListener('contextmenu', handler);\r\n        window.removeEventListener('mousemove', handler);\r\n      }\r\n\r\n      handler = null;\r\n      touchStartFired = false;\r\n    };\r\n    // });\r\n\r\n    callback?.(clickId);\r\n\r\n    /* callback().then((bad) => {\r\n      if(bad) {\r\n        span.remove();\r\n        return;\r\n      } */\r\n\r\n    // console.log('ripple after promise', Date.now() - startTime);\r\n    // console.log('ripple tooSlow:', tooSlow);\r\n    /* if(tooSlow) {\r\n        span.remove();\r\n        return;\r\n      } */\r\n\r\n    fastRaf(() => {\r\n      if(_handler !== handler) {\r\n        return;\r\n      }\r\n\r\n      const rect = r.getBoundingClientRect();\r\n      circle.classList.add('c-ripple__circle');\r\n\r\n      const clickX = clientX - rect.left;\r\n      const clickY = clientY - rect.top;\r\n\r\n      const radius = Math.sqrt((Math.abs(clickY - rect.height / 2) + rect.height / 2) ** 2 + (Math.abs(clickX - rect.width / 2) + rect.width / 2) ** 2);\r\n      const size = radius;\r\n\r\n      // center of circle\r\n      const x = clickX - size / 2;\r\n      const y = clickY - size / 2;\r\n\r\n      // console.log('ripple click', offsetFromCenter, size, clickX, clickY);\r\n\r\n      circle.style.width = circle.style.height = size + 'px';\r\n      circle.style.left = x + 'px';\r\n      circle.style.top = y + 'px';\r\n      circle.style.opacity = '0';\r\n\r\n      // нижний код выполняется с задержкой\r\n      /* animationEndPromise = new Promise((resolve) => {\r\n          span.addEventListener('animationend', () => {\r\n            // 713 -> 700\r\n            resolve(((Date.now() - startTime) / 100 | 0) * 100);\r\n          }, {once: true});\r\n        }); */\r\n\r\n      // нижний код не всегда включает анимацию ПРИ КЛИКЕ НА ТАЧПАД БЕЗ ТАПТИК ЭНЖИНА\r\n      /* span.style.display = 'none';\r\n        r.append(span);\r\n        duration = +window.getComputedStyle(span).getPropertyValue('animation-duration').replace('s', '') * 1000;\r\n        span.style.display = ''; */\r\n\r\n      r.append(circle);\r\n\r\n      void circle.offsetWidth; // force reflow\r\n      circle.style.opacity = '';\r\n\r\n      if(auto) {\r\n        // window.addEventListener('mousemove', handler, {once: true, passive: true});\r\n        handler();\r\n      }\r\n\r\n      // r.classList.add('active');\r\n      // handler();\r\n    });\r\n    // });\r\n  };\r\n\r\n  const isRippleUnneeded = (e: Event) => {\r\n    return e.target !== elem && (\r\n      ['BUTTON', 'A'].includes((e.target as HTMLElement).tagName) ||\r\n        findUpClassName(e.target as HTMLElement, 'c-ripple') !== r\r\n    ) && (\r\n      attachListenerTo === elem ||\r\n        !findUpAsChild(e.target as HTMLElement, attachListenerTo)\r\n    ) && !findUpClassName(e.target, 'checkbox-field');\r\n  };\r\n\r\n  // TODO: rename this variable\r\n  let touchStartFired = false;\r\n  if(IS_TOUCH_SUPPORTED) {\r\n    const touchEnd = () => {\r\n      handler?.();\r\n    };\r\n\r\n    const onTouchStart = (e: TouchEvent) => {\r\n      if(!liteMode.isAvailable('animations')) {\r\n        return;\r\n      }\r\n\r\n      // console.log('ripple touchstart', e);\r\n      if(e.touches.length > 1 || touchStartFired || isRippleUnneeded(e)) {\r\n        return;\r\n      }\r\n\r\n      // console.log('touchstart', e);\r\n      touchStartFired = true;\r\n\r\n      const {clientX, clientY} = e.touches[0];\r\n      drawRipple(clientX, clientY);\r\n      attachListenerTo.addEventListener('touchend', touchEnd, {once: true});\r\n\r\n      window.addEventListener('touchmove', (e) => {\r\n        e.cancelBubble = true;\r\n        e.stopPropagation();\r\n        touchEnd();\r\n        attachListenerTo.removeEventListener('touchend', touchEnd);\r\n      }, {once: true});\r\n    };\r\n\r\n    attachListenerTo.addEventListener('touchstart', onTouchStart, {passive: true});\r\n    return {\r\n      dispose: () => attachListenerTo.removeEventListener('touchstart', onTouchStart),\r\n      element: r\r\n    };\r\n  } else {\r\n    const onMouseDown = (e: MouseEvent) => {\r\n      if(![0, 2].includes(e.button)) { // only left and right buttons\r\n        return;\r\n      }\r\n\r\n      if(!liteMode.isAvailable('animations')) {\r\n        return;\r\n      }\r\n      // console.log('ripple mousedown', e, e.target, findUpClassName(e.target as HTMLElement, 'c-ripple') === r);\r\n\r\n      if(attachListenerTo.dataset.ripple === '0' || isRippleUnneeded(e)) {\r\n        return;\r\n      } else if(touchStartFired) {\r\n        touchStartFired = false;\r\n        return;\r\n      }\r\n\r\n      const {clientX, clientY} = e;\r\n      drawRipple(clientX, clientY);\r\n      window.addEventListener('mouseup', handler, {once: true, passive: true});\r\n      window.addEventListener('contextmenu', handler, {once: true, passive: true});\r\n    };\r\n\r\n    attachListenerTo.addEventListener('mousedown', onMouseDown, {passive: true});\r\n    return {\r\n      dispose: () => attachListenerTo.removeEventListener('mousedown', onMouseDown),\r\n      element: r\r\n    };\r\n  }\r\n}\r\n","const Icons = {\r\n  check: 'e900',\r\n  checks: 'e901',\r\n  activesessions: 'e902',\r\n  add: 'e903',\r\n  add_reaction: 'e904',\r\n  addboost: 'e905',\r\n  addmember_filled: 'e906',\r\n  adduser: 'e907',\r\n  admin: 'e908',\r\n  ads: 'e909',\r\n  animals: 'e90a',\r\n  animations: 'e90b',\r\n  archive: 'e90c',\r\n  arrow_down: 'e90d',\r\n  arrow_next: 'e90e',\r\n  arrow_prev: 'e90f',\r\n  arrowcircle: 'e910',\r\n  arrowhead: 'e911',\r\n  attach: 'e912',\r\n  audio_repeat: 'e913',\r\n  audio_repeat_single: 'e914',\r\n  author_hidden: 'e915',\r\n  avatarnext: 'e916',\r\n  avatarprevious: 'e917',\r\n  binfilled: 'e918',\r\n  bold: 'e919',\r\n  bomb: 'e91a',\r\n  boost: 'e91b',\r\n  boostcircle: 'e91c',\r\n  botcom: 'e91d',\r\n  bots: 'e91e',\r\n  bubblereply: 'e91f',\r\n  bug: 'e920',\r\n  calendar: 'e921',\r\n  calendarfilter: 'e922',\r\n  camera: 'e923',\r\n  cameraadd: 'e924',\r\n  captiondown: 'e925',\r\n  captionup: 'e926',\r\n  car: 'e927',\r\n  card: 'e928',\r\n  card_outline: 'e929',\r\n  cash_circle: 'e92a',\r\n  channel: 'e92b',\r\n  channelviews: 'e92c',\r\n  chatspinned: 'e92d',\r\n  chatsplaceholder: 'e92e',\r\n  check1: 'e92f',\r\n  checkbox: 'e930',\r\n  checkboxblock: 'e931',\r\n  checkboxempty: 'e932',\r\n  checkboxon: 'e933',\r\n  checkretract: 'e934',\r\n  checkround: 'e935',\r\n  checkround_filled: 'e936',\r\n  clock: 'e937',\r\n  close: 'e938',\r\n  clouddownload: 'e939',\r\n  collapse: 'e93a',\r\n  colorize: 'e93b',\r\n  comments: 'e93c',\r\n  commentssticker: 'e93d',\r\n  copy: 'e93e',\r\n  crossgif: 'e93f',\r\n  crossround: 'e940',\r\n  crossstar: 'e941',\r\n  darkmode: 'e942',\r\n  data: 'e943',\r\n  delete: 'e944',\r\n  delete_filled: 'e945',\r\n  deletedaccount: 'e946',\r\n  deleteleft: 'e947',\r\n  deleteuser: 'e948',\r\n  devices: 'e949',\r\n  document: 'e94a',\r\n  down: 'e94b',\r\n  download: 'e94c',\r\n  dragfiles: 'e94d',\r\n  dragmedia: 'e94e',\r\n  eats: 'e94f',\r\n  edit: 'e950',\r\n  email: 'e951',\r\n  endcall_filled: 'e952',\r\n  enter: 'e953',\r\n  expand: 'e954',\r\n  eye: 'e955',\r\n  eye1: 'e956',\r\n  eye2: 'e957',\r\n  eyecross_outline: 'e958',\r\n  factcheck: 'e959',\r\n  fast_forward: 'e95a',\r\n  fast_rewind: 'e95b',\r\n  favourites: 'e95c',\r\n  flag: 'e95d',\r\n  flip: 'e95e',\r\n  folder: 'e95f',\r\n  fontsize: 'e960',\r\n  forward: 'e961',\r\n  forward_filled: 'e962',\r\n  fullscreen: 'e963',\r\n  gc_microphone: 'e964',\r\n  gc_microphoneoff: 'e965',\r\n  gifs: 'e966',\r\n  gift: 'e967',\r\n  gift_premium: 'e968',\r\n  group: 'e969',\r\n  group_filled: 'e96a',\r\n  groupmedia: 'e96b',\r\n  groupmediaoff: 'e96c',\r\n  hand: 'e96d',\r\n  help: 'e96e',\r\n  hide: 'e96f',\r\n  image: 'e970',\r\n  info: 'e971',\r\n  info2: 'e972',\r\n  italic: 'e973',\r\n  keyboard: 'e974',\r\n  lamp: 'e975',\r\n  language: 'e976',\r\n  largepause: 'e977',\r\n  largeplay: 'e978',\r\n  left: 'e979',\r\n  limit_chat: 'e97a',\r\n  limit_chats: 'e97b',\r\n  limit_file: 'e97c',\r\n  limit_folders: 'e97d',\r\n  limit_link: 'e97e',\r\n  limit_pin: 'e97f',\r\n  link: 'e980',\r\n  list: 'e981',\r\n  listscreenshare: 'e982',\r\n  livelocation: 'e983',\r\n  location: 'e984',\r\n  lock: 'e985',\r\n  lockoff: 'e986',\r\n  loginlogodesktop: 'e987',\r\n  loginlogomobile: 'e988',\r\n  logout: 'e989',\r\n  mediaspoiler: 'e98a',\r\n  mediaspoileroff: 'e98b',\r\n  mention: 'e98c',\r\n  menu: 'e98d',\r\n  message: 'e98e',\r\n  message_jump: 'e98f',\r\n  message_quote: 'e990',\r\n  messageunread: 'e991',\r\n  microphone: 'e992',\r\n  microphone_crossed: 'e993',\r\n  microphone_crossed_filled: 'e994',\r\n  microphone_filled: 'e995',\r\n  minus: 'e996',\r\n  monospace: 'e997',\r\n  more: 'e998',\r\n  multistories: 'e999',\r\n  mute: 'e99a',\r\n  muted: 'e99b',\r\n  mynotes: 'e99c',\r\n  newchannel: 'e99d',\r\n  newchannel_filled: 'e99e',\r\n  newchat_filled: 'e99f',\r\n  newgroup: 'e9a0',\r\n  newgroup_filled: 'e9a1',\r\n  newprivate: 'e9a2',\r\n  newprivate_filled: 'e9a3',\r\n  newtab: 'e9a4',\r\n  next: 'e9a5',\r\n  nochannel: 'e9a6',\r\n  noncontacts: 'e9a7',\r\n  nosound: 'e9a8',\r\n  online: 'e9a9',\r\n  passwordoff: 'e9aa',\r\n  pause: 'e9ab',\r\n  permissions: 'e9ac',\r\n  phone: 'e9ad',\r\n  phone_filled: 'e9ae',\r\n  pin: 'e9af',\r\n  pin2: 'e9b0',\r\n  pinlist: 'e9b1',\r\n  pinned_filled: 'e9b2',\r\n  pinnedchat: 'e9b3',\r\n  pip: 'e9b4',\r\n  play: 'e9b5',\r\n  playback_05: 'e9b6',\r\n  playback_15: 'e9b7',\r\n  playback_1x: 'e9b8',\r\n  playback_2x: 'e9b9',\r\n  plus: 'e9ba',\r\n  plusround: 'e9bb',\r\n  poll: 'e9bc',\r\n  premium_addone: 'e9bd',\r\n  premium_avatars: 'e9be',\r\n  premium_badge: 'e9bf',\r\n  premium_colors: 'e9c0',\r\n  premium_double: 'e9c1',\r\n  premium_emoji: 'e9c2',\r\n  premium_filesize: 'e9c3',\r\n  premium_lastseen: 'e9c4',\r\n  premium_limits: 'e9c5',\r\n  premium_lock: 'e9c6',\r\n  premium_management: 'e9c7',\r\n  premium_noads: 'e9c8',\r\n  premium_privacy: 'e9c9',\r\n  premium_reactions: 'e9ca',\r\n  premium_restrict: 'e9cb',\r\n  premium_speed: 'e9cc',\r\n  premium_status: 'e9cd',\r\n  premium_stickers: 'e9ce',\r\n  premium_tags: 'e9cf',\r\n  premium_transcription: 'e9d0',\r\n  premium_translate: 'e9d1',\r\n  premium_unlock: 'e9d2',\r\n  premium_wallpaper: 'e9d3',\r\n  previous: 'e9d4',\r\n  promote: 'e9d5',\r\n  quote: 'e9d6',\r\n  quote_outline: 'e9d7',\r\n  radiooff: 'e9d8',\r\n  radioon: 'e9d9',\r\n  reactions: 'e9da',\r\n  reactions_filled: 'e9db',\r\n  readchats: 'e9dc',\r\n  recent: 'e9dd',\r\n  replace: 'e9de',\r\n  reply: 'e9df',\r\n  reply_filled: 'e9e0',\r\n  restrict: 'e9e1',\r\n  revenue: 'e9e2',\r\n  rightpanel: 'e9e3',\r\n  rotate_left: 'e9e4',\r\n  rotate_right: 'e9e5',\r\n  saved: 'e9e6',\r\n  savedmessages: 'e9e7',\r\n  schedule: 'e9e8',\r\n  scheduled: 'e9e9',\r\n  search: 'e9ea',\r\n  select: 'e9eb',\r\n  send: 'e9ec',\r\n  send2: 'e9ed',\r\n  sending: 'e9ee',\r\n  sendingerror: 'e9ef',\r\n  settings: 'e9f0',\r\n  settings_filled: 'e9f1',\r\n  sharescreen_filled: 'e9f2',\r\n  shipping: 'e9f3',\r\n  shuffle: 'e9f4',\r\n  smallscreen: 'e9f5',\r\n  smile: 'e9f6',\r\n  speaker: 'e9f7',\r\n  speakerfilled: 'e9f8',\r\n  speakeroff: 'e9f9',\r\n  speakerofffilled: 'e9fa',\r\n  spoiler: 'e9fb',\r\n  sport: 'e9fc',\r\n  star: 'e9fd',\r\n  star_filled: 'e9fe',\r\n  statistics: 'e9ff',\r\n  stickers: 'ea00',\r\n  stickers_face: 'ea01',\r\n  stop: 'ea02',\r\n  stories: 'ea03',\r\n  storyreply: 'ea04',\r\n  storyrepost: 'ea05',\r\n  strikethrough: 'ea06',\r\n  tag: 'ea07',\r\n  tag_add: 'ea08',\r\n  tag_crossed: 'ea09',\r\n  tag_filter: 'ea0a',\r\n  tag_name: 'ea0b',\r\n  textedit: 'ea0c',\r\n  timer: 'ea0d',\r\n  tip: 'ea0e',\r\n  tools: 'ea0f',\r\n  topics: 'ea10',\r\n  transcribe: 'ea11',\r\n  unarchive: 'ea12',\r\n  unclaimed: 'ea13',\r\n  underline: 'ea14',\r\n  unmute: 'ea15',\r\n  unpin: 'ea16',\r\n  unread: 'ea17',\r\n  up: 'ea18',\r\n  user: 'ea19',\r\n  username: 'ea1a',\r\n  videocamera: 'ea1b',\r\n  videocamera_crossed_filled: 'ea1c',\r\n  videocamera_filled: 'ea1d',\r\n  videochat: 'ea1e',\r\n  volume_down: 'ea1f',\r\n  volume_mute: 'ea20',\r\n  volume_off: 'ea21',\r\n  volume_up: 'ea22',\r\n  webview: 'ea23',\r\n  zoomin: 'ea24',\r\n  zoomout: 'ea25'\r\n};\r\n\r\nexport default Icons;\r\n","const IconsReverse = new Set<Icon>([\r\n  'avatarnext',\r\n  'avatarprevious',\r\n  'arrow_next',\r\n  'channel',\r\n  'chatspinned',\r\n  'fast_forward',\r\n  'fast_rewind',\r\n  'forward',\r\n  'forward_filled',\r\n  'group',\r\n  'group_filled',\r\n  'left',\r\n  'listscreenshare',\r\n  'logout',\r\n  'muted',\r\n  'newchannel_filled',\r\n  'newchannel',\r\n  'newgroup',\r\n  'newgroup_filled',\r\n  'next',\r\n  'nosound',\r\n  'previous',\r\n  'send',\r\n  'send2',\r\n  'reply',\r\n  'reply_filled',\r\n  'sharescreen_filled',\r\n  'transcribe',\r\n  'storyreply',\r\n  'premium_noads',\r\n  'topics',\r\n  'pinlist',\r\n  'deleteleft'\r\n]);\r\n\r\nexport default IconsReverse;\r\n","import {TGICO_CLASS} from '../helpers/tgico';\r\nimport Icons from '../icons';\r\nimport IconsReverse from '../iconsReverse';\r\nimport I18n from '../lib/langPack';\r\n\r\nexport function getIconContent(icon: Icon) {\r\n  return String.fromCharCode(parseInt(Icons[icon], 16));\r\n}\r\n\r\nexport default function Icon(icon: Icon, ...classes: string[]) {\r\n  const span = document.createElement('span');\r\n  if(I18n.isRTL && IconsReverse.has(icon)) {\r\n    classes.push('icon-reflect');\r\n  }\r\n\r\n  span.classList.add(TGICO_CLASS/* ...tgico(icon) */, ...classes);\r\n  span.textContent = getIconContent(icon);\r\n  return span;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport {FormatterArguments, i18n, LangPackKey} from '../lib/langPack';\r\nimport Icon from './icon';\r\nimport ripple from './ripple';\r\n\r\nexport type ButtonOptions = Partial<{\r\n  noRipple: true,\r\n  onlyMobile: true,\r\n  icon: Icon,\r\n  rippleSquare: true,\r\n  text: LangPackKey,\r\n  textArgs?: FormatterArguments,\r\n  disabled: boolean,\r\n  asDiv: boolean,\r\n  asLink: boolean\r\n}>;\r\n\r\nexport default function Button<T extends ButtonOptions>(className: string, options: T = {} as T): T['asLink'] extends true ? HTMLAnchorElement : HTMLButtonElement {\r\n  const button = document.createElement(options.asLink ? 'a' : (options.asDiv ? 'div' : 'button'));\r\n  button.className = className;\r\n\r\n  if(!options.noRipple) {\r\n    if(options.rippleSquare) {\r\n      button.classList.add('rp-square');\r\n    }\r\n\r\n    ripple(button);\r\n  }\r\n\r\n  if(options.icon) {\r\n    replaceButtonIcon(button, options.icon, false);\r\n  }\r\n\r\n  if(options.onlyMobile) {\r\n    button.classList.add('only-handhelds');\r\n  }\r\n\r\n  if(options.disabled) {\r\n    button.setAttribute('disabled', 'true');\r\n  }\r\n\r\n  if(options.text) {\r\n    button.append(i18n(options.text, options.textArgs));\r\n  }\r\n\r\n  return button as any;\r\n}\r\n\r\nexport function replaceButtonIcon(element: HTMLElement, icon: Icon, oldIcon: Element | false = element.querySelector('.button-icon')) {\r\n  const newIcon = Icon(icon, 'button-icon');\r\n  if(oldIcon) oldIcon.replaceWith(newIcon);\r\n  else element.append(newIcon);\r\n  return newIcon;\r\n}\r\n"],"names":["SequentialDom","fastRaf","kind","callback","promise","deferredPromise","element","isConnected","isInDOM","sequentialDom","MOUNT_CLASS_TO","rippleClickId","ripple","elem","onEnd","prepend","attachListenerTo","r","handler","drawRipple","clientX","clientY","startTime","circle","clickId","duration","_handler","elapsedTime","cb","delay","IS_TOUCH_SUPPORTED","touchStartFired","rect","clickX","clickY","size","x","y","isRippleUnneeded","e","findUpClassName","findUpAsChild","touchEnd","onTouchStart","liteMode","onMouseDown","Icons","IconsReverse","getIconContent","icon","Icon","classes","span","I18n","TGICO_CLASS","Button","className","options","button","replaceButtonIcon","i18n","oldIcon","newIcon"],"mappings":"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"}