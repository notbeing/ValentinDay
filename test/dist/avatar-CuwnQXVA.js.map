{"version":3,"file":"avatar-CuwnQXVA.js","sources":["../src/helpers/dom/isSendShortcutPressed.ts","../src/helpers/dom/fullScreen.ts","../src/components/buttonIcon.ts","../src/vendor/solid/web/dist/web.js","../src/components/popups/index.ts","../src/lib/cropper.ts","../src/helpers/blob/readBlobAs.ts","../src/helpers/blob/readBlobAsDataURL.ts","../src/components/popups/avatar.ts"],"sourcesContent":["/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport rootScope from '../../lib/rootScope';\r\nimport {IS_MOBILE, IS_APPLE} from '../../environment/userAgent';\r\n\r\nexport default function isSendShortcutPressed(e: KeyboardEvent) {\r\n  if(e.key === 'Enter' && !IS_MOBILE && !e.isComposing) {\r\n    /* if(e.ctrlKey || e.metaKey) {\r\n      this.messageInput.innerHTML += '<br>';\r\n      placeCaretAtEnd(this.message)\r\n      return;\r\n    } */\r\n\r\n    if(rootScope.settings.sendShortcut === 'enter') {\r\n      if(e.shiftKey || e.ctrlKey || e.metaKey) {\r\n        return;\r\n      }\r\n\r\n      return true;\r\n    } else {\r\n      const secondaryKey = IS_APPLE ? e.metaKey : e.ctrlKey;\r\n      if(e.shiftKey || (IS_APPLE ? e.ctrlKey : e.metaKey)) {\r\n        return;\r\n      }\r\n\r\n      if(secondaryKey) {\r\n        return true;\r\n      }\r\n    }\r\n  }\r\n\r\n  return false;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport type ListenerSetter from '../listenerSetter';\r\n\r\nexport function requestFullScreen(element: HTMLElement) {\r\n  if(element.requestFullscreen) {\r\n    element.requestFullscreen();\r\n    // @ts-ignore\r\n  } else if(element.mozRequestFullScreen) {\r\n    // @ts-ignore\r\n    element.mozRequestFullScreen(); // Firefox\r\n    // @ts-ignore\r\n  } else if(element.webkitRequestFullscreen) {\r\n    // @ts-ignore\r\n    element.webkitRequestFullscreen(); // Chrome and Safari\r\n    // @ts-ignore\r\n  } else if(element.msRequestFullscreen) {\r\n    // @ts-ignore\r\n    element.msRequestFullscreen();\r\n  }\r\n}\r\n\r\nexport function cancelFullScreen() {\r\n  // @ts-ignore\r\n  if(document.cancelFullScreen) {\r\n    // @ts-ignore\r\n    document.cancelFullScreen();\r\n    // @ts-ignore\r\n  } else if(document.mozCancelFullScreen) {\r\n    // @ts-ignore\r\n    document.mozCancelFullScreen();\r\n    // @ts-ignore\r\n  } else if(document.webkitCancelFullScreen) {\r\n    // @ts-ignore\r\n    document.webkitCancelFullScreen();\r\n    // @ts-ignore\r\n  } else if(document.msExitFullscreen) {\r\n    // @ts-ignore\r\n    document.msExitFullscreen();\r\n  }\r\n}\r\n\r\nexport function addFullScreenListener(element: HTMLElement, callback: (e: Event) => any, listenerSetter?: ListenerSetter) {\r\n  const addListener = listenerSetter ? listenerSetter.add(element) : element.addEventListener.bind(element);\r\n  'webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange'.split(' ').forEach((eventName) => {\r\n    addListener(eventName, callback, false);\r\n  });\r\n}\r\n\r\nexport function getFullScreenElement(): HTMLElement {\r\n  // @ts-ignore\r\n  return document.fullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement || document.msFullscreenElement;\r\n}\r\n\r\nexport function isFullScreen() {\r\n  return !!getFullScreenElement();\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport Button from './button';\r\n\r\nconst ButtonIcon = (className?: string, options: Partial<{noRipple: true, onlyMobile: true, asDiv: boolean}> = {}) => {\r\n  const splitted = className?.split(' ');\r\n  const button = Button('btn-icon' + (splitted?.length > 1 ? ' ' + splitted.slice(1).join(' ') : ''), {\r\n    icon: splitted?.[0] as Icon || undefined,\r\n    ...options\r\n  });\r\n\r\n  return button;\r\n};\r\n\r\nexport default ButtonIcon;\r\n","import { createRoot, createRenderEffect, sharedConfig, untrack, enableHydration, getOwner, createEffect, runWithOwner, createMemo, createSignal, onCleanup, splitProps } from 'solid-js';\r\nexport { ErrorBoundary, For, Index, Match, Show, Suspense, SuspenseList, Switch, createComponent, createRenderEffect as effect, getOwner, createMemo as memo, mergeProps, untrack } from 'solid-js';\r\n\r\nconst booleans = [\"allowfullscreen\", \"async\", \"autofocus\", \"autoplay\", \"checked\", \"controls\", \"default\", \"disabled\", \"formnovalidate\", \"hidden\", \"indeterminate\", \"ismap\", \"loop\", \"multiple\", \"muted\", \"nomodule\", \"novalidate\", \"open\", \"playsinline\", \"readonly\", \"required\", \"reversed\", \"seamless\", \"selected\"];\r\nconst Properties = /*#__PURE__*/new Set([\"className\", \"value\", \"readOnly\", \"formNoValidate\", \"isMap\", \"noModule\", \"playsInline\", ...booleans]);\r\nconst ChildProperties = /*#__PURE__*/new Set([\"innerHTML\", \"textContent\", \"innerText\", \"children\"]);\r\nconst Aliases = /*#__PURE__*/Object.assign(Object.create(null), {\r\n  className: \"class\",\r\n  htmlFor: \"for\"\r\n});\r\nconst PropAliases = /*#__PURE__*/Object.assign(Object.create(null), {\r\n  class: \"className\",\r\n  formnovalidate: {\r\n    $: \"formNoValidate\",\r\n    BUTTON: 1,\r\n    INPUT: 1\r\n  },\r\n  ismap: {\r\n    $: \"isMap\",\r\n    IMG: 1\r\n  },\r\n  nomodule: {\r\n    $: \"noModule\",\r\n    SCRIPT: 1\r\n  },\r\n  playsinline: {\r\n    $: \"playsInline\",\r\n    VIDEO: 1\r\n  },\r\n  readonly: {\r\n    $: \"readOnly\",\r\n    INPUT: 1,\r\n    TEXTAREA: 1\r\n  }\r\n});\r\nfunction getPropAlias(prop, tagName) {\r\n  const a = PropAliases[prop];\r\n  return typeof a === \"object\" ? a[tagName] ? a[\"$\"] : undefined : a;\r\n}\r\nconst DelegatedEvents = /*#__PURE__*/new Set([\"beforeinput\", \"click\", \"dblclick\", \"contextmenu\", \"focusin\", \"focusout\", \"input\", \"keydown\", \"keyup\", \"mousedown\", \"mousemove\", \"mouseout\", \"mouseover\", \"mouseup\", \"pointerdown\", \"pointermove\", \"pointerout\", \"pointerover\", \"pointerup\", \"touchend\", \"touchmove\", \"touchstart\"]);\r\nconst SVGElements = /*#__PURE__*/new Set([\r\n\"altGlyph\", \"altGlyphDef\", \"altGlyphItem\", \"animate\", \"animateColor\", \"animateMotion\", \"animateTransform\", \"circle\", \"clipPath\", \"color-profile\", \"cursor\", \"defs\", \"desc\", \"ellipse\", \"feBlend\", \"feColorMatrix\", \"feComponentTransfer\", \"feComposite\", \"feConvolveMatrix\", \"feDiffuseLighting\", \"feDisplacementMap\", \"feDistantLight\", \"feFlood\", \"feFuncA\", \"feFuncB\", \"feFuncG\", \"feFuncR\", \"feGaussianBlur\", \"feImage\", \"feMerge\", \"feMergeNode\", \"feMorphology\", \"feOffset\", \"fePointLight\", \"feSpecularLighting\", \"feSpotLight\", \"feTile\", \"feTurbulence\", \"filter\", \"font\", \"font-face\", \"font-face-format\", \"font-face-name\", \"font-face-src\", \"font-face-uri\", \"foreignObject\", \"g\", \"glyph\", \"glyphRef\", \"hkern\", \"image\", \"line\", \"linearGradient\", \"marker\", \"mask\", \"metadata\", \"missing-glyph\", \"mpath\", \"path\", \"pattern\", \"polygon\", \"polyline\", \"radialGradient\", \"rect\",\r\n\"set\", \"stop\",\r\n\"svg\", \"switch\", \"symbol\", \"text\", \"textPath\",\r\n\"tref\", \"tspan\", \"use\", \"view\", \"vkern\"]);\r\nconst SVGNamespace = {\r\n  xlink: \"http://www.w3.org/1999/xlink\",\r\n  xml: \"http://www.w3.org/XML/1998/namespace\"\r\n};\r\nconst DOMElements = /*#__PURE__*/new Set([\"html\", \"base\", \"head\", \"link\", \"meta\", \"style\", \"title\", \"body\", \"address\", \"article\", \"aside\", \"footer\", \"header\", \"main\", \"nav\", \"section\", \"body\", \"blockquote\", \"dd\", \"div\", \"dl\", \"dt\", \"figcaption\", \"figure\", \"hr\", \"li\", \"ol\", \"p\", \"pre\", \"ul\", \"a\", \"abbr\", \"b\", \"bdi\", \"bdo\", \"br\", \"cite\", \"code\", \"data\", \"dfn\", \"em\", \"i\", \"kbd\", \"mark\", \"q\", \"rp\", \"rt\", \"ruby\", \"s\", \"samp\", \"small\", \"span\", \"strong\", \"sub\", \"sup\", \"time\", \"u\", \"var\", \"wbr\", \"area\", \"audio\", \"img\", \"map\", \"track\", \"video\", \"embed\", \"iframe\", \"object\", \"param\", \"picture\", \"portal\", \"source\", \"svg\", \"math\", \"canvas\", \"noscript\", \"script\", \"del\", \"ins\", \"caption\", \"col\", \"colgroup\", \"table\", \"tbody\", \"td\", \"tfoot\", \"th\", \"thead\", \"tr\", \"button\", \"datalist\", \"fieldset\", \"form\", \"input\", \"label\", \"legend\", \"meter\", \"optgroup\", \"option\", \"output\", \"progress\", \"select\", \"textarea\", \"details\", \"dialog\", \"menu\", \"summary\", \"details\", \"slot\", \"template\", \"acronym\", \"applet\", \"basefont\", \"bgsound\", \"big\", \"blink\", \"center\", \"content\", \"dir\", \"font\", \"frame\", \"frameset\", \"hgroup\", \"image\", \"keygen\", \"marquee\", \"menuitem\", \"nobr\", \"noembed\", \"noframes\", \"plaintext\", \"rb\", \"rtc\", \"shadow\", \"spacer\", \"strike\", \"tt\", \"xmp\", \"a\", \"abbr\", \"acronym\", \"address\", \"applet\", \"area\", \"article\", \"aside\", \"audio\", \"b\", \"base\", \"basefont\", \"bdi\", \"bdo\", \"bgsound\", \"big\", \"blink\", \"blockquote\", \"body\", \"br\", \"button\", \"canvas\", \"caption\", \"center\", \"cite\", \"code\", \"col\", \"colgroup\", \"content\", \"data\", \"datalist\", \"dd\", \"del\", \"details\", \"dfn\", \"dialog\", \"dir\", \"div\", \"dl\", \"dt\", \"em\", \"embed\", \"fieldset\", \"figcaption\", \"figure\", \"font\", \"footer\", \"form\", \"frame\", \"frameset\", \"head\", \"header\", \"hgroup\", \"hr\", \"html\", \"i\", \"iframe\", \"image\", \"img\", \"input\", \"ins\", \"kbd\", \"keygen\", \"label\", \"legend\", \"li\", \"link\", \"main\", \"map\", \"mark\", \"marquee\", \"menu\", \"menuitem\", \"meta\", \"meter\", \"nav\", \"nobr\", \"noembed\", \"noframes\", \"noscript\", \"object\", \"ol\", \"optgroup\", \"option\", \"output\", \"p\", \"param\", \"picture\", \"plaintext\", \"portal\", \"pre\", \"progress\", \"q\", \"rb\", \"rp\", \"rt\", \"rtc\", \"ruby\", \"s\", \"samp\", \"script\", \"section\", \"select\", \"shadow\", \"slot\", \"small\", \"source\", \"spacer\", \"span\", \"strike\", \"strong\", \"style\", \"sub\", \"summary\", \"sup\", \"table\", \"tbody\", \"td\", \"template\", \"textarea\", \"tfoot\", \"th\", \"thead\", \"time\", \"title\", \"tr\", \"track\", \"tt\", \"u\", \"ul\", \"var\", \"video\", \"wbr\", \"xmp\", \"input\", \"h1\", \"h2\", \"h3\", \"h4\", \"h5\", \"h6\"]);\r\n\r\nfunction reconcileArrays(parentNode, a, b) {\r\n  let bLength = b.length,\r\n    aEnd = a.length,\r\n    bEnd = bLength,\r\n    aStart = 0,\r\n    bStart = 0,\r\n    after = a[aEnd - 1].nextSibling,\r\n    map = null;\r\n  while (aStart < aEnd || bStart < bEnd) {\r\n    if (a[aStart] === b[bStart]) {\r\n      aStart++;\r\n      bStart++;\r\n      continue;\r\n    }\r\n    while (a[aEnd - 1] === b[bEnd - 1]) {\r\n      aEnd--;\r\n      bEnd--;\r\n    }\r\n    if (aEnd === aStart) {\r\n      const node = bEnd < bLength ? bStart ? b[bStart - 1].nextSibling : b[bEnd - bStart] : after;\r\n      while (bStart < bEnd) parentNode.insertBefore(b[bStart++], node);\r\n    } else if (bEnd === bStart) {\r\n      while (aStart < aEnd) {\r\n        if (!map || !map.has(a[aStart])) a[aStart].remove();\r\n        aStart++;\r\n      }\r\n    } else if (a[aStart] === b[bEnd - 1] && b[bStart] === a[aEnd - 1]) {\r\n      const node = a[--aEnd].nextSibling;\r\n      parentNode.insertBefore(b[bStart++], a[aStart++].nextSibling);\r\n      parentNode.insertBefore(b[--bEnd], node);\r\n      a[aEnd] = b[bEnd];\r\n    } else {\r\n      if (!map) {\r\n        map = new Map();\r\n        let i = bStart;\r\n        while (i < bEnd) map.set(b[i], i++);\r\n      }\r\n      const index = map.get(a[aStart]);\r\n      if (index != null) {\r\n        if (bStart < index && index < bEnd) {\r\n          let i = aStart,\r\n            sequence = 1,\r\n            t;\r\n          while (++i < aEnd && i < bEnd) {\r\n            if ((t = map.get(a[i])) == null || t !== index + sequence) break;\r\n            sequence++;\r\n          }\r\n          if (sequence > index - bStart) {\r\n            const node = a[aStart];\r\n            while (bStart < index) parentNode.insertBefore(b[bStart++], node);\r\n          } else parentNode.replaceChild(b[bStart++], a[aStart++]);\r\n        } else aStart++;\r\n      } else a[aStart++].remove();\r\n    }\r\n  }\r\n}\r\n\r\nconst $$EVENTS = \"_$DX_DELEGATE\";\r\nfunction render(code, element, init, options = {}) {\r\n  let disposer;\r\n  createRoot(dispose => {\r\n    disposer = dispose;\r\n    element === document ? code() : insert(element, code(), element.firstChild ? null : undefined, init);\r\n  }, options.owner);\r\n  return () => {\r\n    disposer();\r\n    element.textContent = \"\";\r\n  };\r\n}\r\nfunction template(html, isCE, isSVG) {\r\n  let node;\r\n  const create = () => {\r\n    const t = document.createElement(\"template\");\r\n    t.innerHTML = html;\r\n    return isSVG ? t.content.firstChild.firstChild : t.content.firstChild;\r\n  };\r\n  const fn = isCE ? () => untrack(() => document.importNode(node || (node = create()), true)) : () => (node || (node = create())).cloneNode(true);\r\n  fn.cloneNode = fn;\r\n  return fn;\r\n}\r\nfunction delegateEvents(eventNames, document = window.document) {\r\n  const e = document[$$EVENTS] || (document[$$EVENTS] = new Set());\r\n  for (let i = 0, l = eventNames.length; i < l; i++) {\r\n    const name = eventNames[i];\r\n    if (!e.has(name)) {\r\n      e.add(name);\r\n      document.addEventListener(name, eventHandler);\r\n    }\r\n  }\r\n}\r\nfunction clearDelegatedEvents(document = window.document) {\r\n  if (document[$$EVENTS]) {\r\n    for (let name of document[$$EVENTS].keys()) document.removeEventListener(name, eventHandler);\r\n    delete document[$$EVENTS];\r\n  }\r\n}\r\nfunction setAttribute(node, name, value) {\r\n  if (value == null) node.removeAttribute(name);else node.setAttribute(name, value);\r\n}\r\nfunction setAttributeNS(node, namespace, name, value) {\r\n  if (value == null) node.removeAttributeNS(namespace, name);else node.setAttributeNS(namespace, name, value);\r\n}\r\nfunction className(node, value) {\r\n  if (value == null) node.removeAttribute(\"class\");else node.className = value;\r\n}\r\nfunction addEventListener(node, name, handler, delegate) {\r\n  if (delegate) {\r\n    if (Array.isArray(handler)) {\r\n      node[`$$${name}`] = handler[0];\r\n      node[`$$${name}Data`] = handler[1];\r\n    } else node[`$$${name}`] = handler;\r\n  } else if (Array.isArray(handler)) {\r\n    const handlerFn = handler[0];\r\n    node.addEventListener(name, handler[0] = e => handlerFn.call(node, handler[1], e));\r\n  } else node.addEventListener(name, handler);\r\n}\r\nfunction classList(node, value, prev = {}) {\r\n  const classKeys = Object.keys(value || {}),\r\n    prevKeys = Object.keys(prev);\r\n  let i, len;\r\n  for (i = 0, len = prevKeys.length; i < len; i++) {\r\n    const key = prevKeys[i];\r\n    if (!key || key === \"undefined\" || value[key]) continue;\r\n    toggleClassKey(node, key, false);\r\n    delete prev[key];\r\n  }\r\n  for (i = 0, len = classKeys.length; i < len; i++) {\r\n    const key = classKeys[i],\r\n      classValue = !!value[key];\r\n    if (!key || key === \"undefined\" || prev[key] === classValue || !classValue) continue;\r\n    toggleClassKey(node, key, true);\r\n    prev[key] = classValue;\r\n  }\r\n  return prev;\r\n}\r\nfunction style(node, value, prev) {\r\n  if (!value) return prev ? setAttribute(node, \"style\") : value;\r\n  const nodeStyle = node.style;\r\n  if (typeof value === \"string\") return nodeStyle.cssText = value;\r\n  typeof prev === \"string\" && (nodeStyle.cssText = prev = undefined);\r\n  prev || (prev = {});\r\n  value || (value = {});\r\n  let v, s;\r\n  for (s in prev) {\r\n    value[s] == null && nodeStyle.removeProperty(s);\r\n    delete prev[s];\r\n  }\r\n  for (s in value) {\r\n    v = value[s];\r\n    if (v !== prev[s]) {\r\n      nodeStyle.setProperty(s, v);\r\n      prev[s] = v;\r\n    }\r\n  }\r\n  return prev;\r\n}\r\nfunction spread(node, props = {}, isSVG, skipChildren) {\r\n  const prevProps = {};\r\n  if (!skipChildren) {\r\n    createRenderEffect(() => prevProps.children = insertExpression(node, props.children, prevProps.children));\r\n  }\r\n  createRenderEffect(() => props.ref && props.ref(node));\r\n  createRenderEffect(() => assign(node, props, isSVG, true, prevProps, true));\r\n  return prevProps;\r\n}\r\nfunction dynamicProperty(props, key) {\r\n  const src = props[key];\r\n  Object.defineProperty(props, key, {\r\n    get() {\r\n      return src();\r\n    },\r\n    enumerable: true\r\n  });\r\n  return props;\r\n}\r\nfunction innerHTML(parent, content) {\r\n  !sharedConfig.context && (parent.innerHTML = content);\r\n}\r\nfunction use(fn, element, arg) {\r\n  return untrack(() => fn(element, arg));\r\n}\r\nfunction insert(parent, accessor, marker, initial) {\r\n  if (marker !== undefined && !initial) initial = [];\r\n  if (typeof accessor !== \"function\") return insertExpression(parent, accessor, initial, marker);\r\n  createRenderEffect(current => insertExpression(parent, accessor(), current, marker), initial);\r\n}\r\nfunction assign(node, props, isSVG, skipChildren, prevProps = {}, skipRef = false) {\r\n  props || (props = {});\r\n  for (const prop in prevProps) {\r\n    if (!(prop in props)) {\r\n      if (prop === \"children\") continue;\r\n      prevProps[prop] = assignProp(node, prop, null, prevProps[prop], isSVG, skipRef);\r\n    }\r\n  }\r\n  for (const prop in props) {\r\n    if (prop === \"children\") {\r\n      if (!skipChildren) insertExpression(node, props.children);\r\n      continue;\r\n    }\r\n    const value = props[prop];\r\n    prevProps[prop] = assignProp(node, prop, value, prevProps[prop], isSVG, skipRef);\r\n  }\r\n}\r\nfunction hydrate$1(code, element, options = {}) {\r\n  sharedConfig.completed = globalThis._$HY.completed;\r\n  sharedConfig.events = globalThis._$HY.events;\r\n  sharedConfig.load = globalThis._$HY.load;\r\n  sharedConfig.gather = root => gatherHydratable(element, root);\r\n  sharedConfig.registry = new Map();\r\n  sharedConfig.context = {\r\n    id: options.renderId || \"\",\r\n    count: 0\r\n  };\r\n  gatherHydratable(element, options.renderId);\r\n  const dispose = render(code, element, [...element.childNodes], options);\r\n  sharedConfig.context = null;\r\n  return dispose;\r\n}\r\nfunction getNextElement(template) {\r\n  let node, key;\r\n  if (!sharedConfig.context || !(node = sharedConfig.registry.get(key = getHydrationKey()))) {\r\n    return template();\r\n  }\r\n  if (sharedConfig.completed) sharedConfig.completed.add(node);\r\n  sharedConfig.registry.delete(key);\r\n  return node;\r\n}\r\nfunction getNextMatch(el, nodeName) {\r\n  while (el && el.localName !== nodeName) el = el.nextSibling;\r\n  return el;\r\n}\r\nfunction getNextMarker(start) {\r\n  let end = start,\r\n    count = 0,\r\n    current = [];\r\n  if (sharedConfig.context) {\r\n    while (end) {\r\n      if (end.nodeType === 8) {\r\n        const v = end.nodeValue;\r\n        if (v === \"#\") count++;else if (v === \"/\") {\r\n          if (count === 0) return [end, current];\r\n          count--;\r\n        }\r\n      }\r\n      current.push(end);\r\n      end = end.nextSibling;\r\n    }\r\n  }\r\n  return [end, current];\r\n}\r\nfunction runHydrationEvents() {\r\n  if (sharedConfig.events && !sharedConfig.events.queued) {\r\n    queueMicrotask(() => {\r\n      const {\r\n        completed,\r\n        events\r\n      } = sharedConfig;\r\n      events.queued = false;\r\n      while (events.length) {\r\n        const [el, e] = events[0];\r\n        if (!completed.has(el)) return;\r\n        eventHandler(e);\r\n        events.shift();\r\n      }\r\n    });\r\n    sharedConfig.events.queued = true;\r\n  }\r\n}\r\nfunction toPropertyName(name) {\r\n  return name.toLowerCase().replace(/-([a-z])/g, (_, w) => w.toUpperCase());\r\n}\r\nfunction toggleClassKey(node, key, value) {\r\n  const classNames = key.trim().split(/\\s+/);\r\n  for (let i = 0, nameLen = classNames.length; i < nameLen; i++) node.classList.toggle(classNames[i], value);\r\n}\r\nfunction assignProp(node, prop, value, prev, isSVG, skipRef) {\r\n  let isCE, isProp, isChildProp, propAlias, forceProp;\r\n  if (prop === \"style\") return style(node, value, prev);\r\n  if (prop === \"classList\") return classList(node, value, prev);\r\n  if (value === prev) return prev;\r\n  if (prop === \"ref\") {\r\n    if (!skipRef) value(node);\r\n  } else if (prop.slice(0, 3) === \"on:\") {\r\n    const e = prop.slice(3);\r\n    prev && node.removeEventListener(e, prev);\r\n    value && node.addEventListener(e, value);\r\n  } else if (prop.slice(0, 10) === \"oncapture:\") {\r\n    const e = prop.slice(10);\r\n    prev && node.removeEventListener(e, prev, true);\r\n    value && node.addEventListener(e, value, true);\r\n  } else if (prop.slice(0, 2) === \"on\") {\r\n    const name = prop.slice(2).toLowerCase();\r\n    const delegate = DelegatedEvents.has(name);\r\n    if (!delegate && prev) {\r\n      const h = Array.isArray(prev) ? prev[0] : prev;\r\n      node.removeEventListener(name, h);\r\n    }\r\n    if (delegate || value) {\r\n      addEventListener(node, name, value, delegate);\r\n      delegate && delegateEvents([name]);\r\n    }\r\n  } else if (prop.slice(0, 5) === \"attr:\") {\r\n    setAttribute(node, prop.slice(5), value);\r\n  } else if ((forceProp = prop.slice(0, 5) === \"prop:\") || (isChildProp = ChildProperties.has(prop)) || !isSVG && ((propAlias = getPropAlias(prop, node.tagName)) || (isProp = Properties.has(prop))) || (isCE = node.nodeName.includes(\"-\"))) {\r\n    if (forceProp) {\r\n      prop = prop.slice(5);\r\n      isProp = true;\r\n    }\r\n    if (prop === \"class\" || prop === \"className\") className(node, value);else if (isCE && !isProp && !isChildProp) node[toPropertyName(prop)] = value;else node[propAlias || prop] = value;\r\n  } else {\r\n    const ns = isSVG && prop.indexOf(\":\") > -1 && SVGNamespace[prop.split(\":\")[0]];\r\n    if (ns) setAttributeNS(node, ns, prop, value);else setAttribute(node, Aliases[prop] || prop, value);\r\n  }\r\n  return value;\r\n}\r\nfunction eventHandler(e) {\r\n  const key = `$$${e.type}`;\r\n  let node = e.composedPath && e.composedPath()[0] || e.target;\r\n  if (e.target !== node) {\r\n    Object.defineProperty(e, \"target\", {\r\n      configurable: true,\r\n      value: node\r\n    });\r\n  }\r\n  Object.defineProperty(e, \"currentTarget\", {\r\n    configurable: true,\r\n    get() {\r\n      return node || document;\r\n    }\r\n  });\r\n  if (sharedConfig.registry && !sharedConfig.done) sharedConfig.done = _$HY.done = true;\r\n  while (node) {\r\n    const handler = node[key];\r\n    if (handler && !node.disabled) {\r\n      const data = node[`${key}Data`];\r\n      data !== undefined ? handler.call(node, data, e) : handler.call(node, e);\r\n      if (e.cancelBubble) return;\r\n    }\r\n    node = node._$host || node.parentNode || node.host;\r\n  }\r\n}\r\nfunction insertExpression(parent, value, current, marker, unwrapArray) {\r\n  if (sharedConfig.context) {\r\n    !current && (current = [...parent.childNodes]);\r\n    let cleaned = [];\r\n    for (let i = 0; i < current.length; i++) {\r\n      const node = current[i];\r\n      if (node.nodeType === 8 && node.data.slice(0, 2) === \"!$\") node.remove();else cleaned.push(node);\r\n    }\r\n    current = cleaned;\r\n  }\r\n  while (typeof current === \"function\") current = current();\r\n  if (value === current) return current;\r\n  const t = typeof value,\r\n    multi = marker !== undefined;\r\n  parent = multi && current[0] && current[0].parentNode || parent;\r\n  if (t === \"string\" || t === \"number\") {\r\n    if (sharedConfig.context) return current;\r\n    if (t === \"number\") value = value.toString();\r\n    if (multi) {\r\n      let node = current[0];\r\n      if (node && node.nodeType === 3) {\r\n        node.data = value;\r\n      } else node = document.createTextNode(value);\r\n      current = cleanChildren(parent, current, marker, node);\r\n    } else {\r\n      if (current !== \"\" && typeof current === \"string\") {\r\n        current = parent.firstChild.data = value;\r\n      } else current = parent.textContent = value;\r\n    }\r\n  } else if (value == null || t === \"boolean\") {\r\n    if (sharedConfig.context) return current;\r\n    current = cleanChildren(parent, current, marker);\r\n  } else if (t === \"function\") {\r\n    createRenderEffect(() => {\r\n      let v = value();\r\n      while (typeof v === \"function\") v = v();\r\n      current = insertExpression(parent, v, current, marker);\r\n    });\r\n    return () => current;\r\n  } else if (Array.isArray(value)) {\r\n    const array = [];\r\n    const currentArray = current && Array.isArray(current);\r\n    if (normalizeIncomingArray(array, value, current, unwrapArray)) {\r\n      createRenderEffect(() => current = insertExpression(parent, array, current, marker, true));\r\n      return () => current;\r\n    }\r\n    if (sharedConfig.context) {\r\n      if (!array.length) return current;\r\n      for (let i = 0; i < array.length; i++) {\r\n        if (array[i].parentNode) return current = array;\r\n      }\r\n    }\r\n    if (array.length === 0) {\r\n      current = cleanChildren(parent, current, marker);\r\n      if (multi) return current;\r\n    } else if (currentArray) {\r\n      if (current.length === 0) {\r\n        appendNodes(parent, array, marker);\r\n      } else reconcileArrays(parent, current, array);\r\n    } else {\r\n      current && cleanChildren(parent);\r\n      appendNodes(parent, array);\r\n    }\r\n    current = array;\r\n  } else if (value.nodeType) {\r\n    if (sharedConfig.context && value.parentNode) return current = multi ? [value] : value;\r\n    if (Array.isArray(current)) {\r\n      if (multi) return current = cleanChildren(parent, current, marker, value);\r\n      cleanChildren(parent, current, null, value);\r\n    } else if (current == null || current === \"\" || !parent.firstChild) {\r\n      parent.appendChild(value);\r\n    } else parent.replaceChild(value, parent.firstChild);\r\n    current = value;\r\n  } else ;\r\n  return current;\r\n}\r\nfunction normalizeIncomingArray(normalized, array, current, unwrap) {\r\n  let dynamic = false;\r\n  for (let i = 0, len = array.length; i < len; i++) {\r\n    let item = array[i],\r\n      prev = current && current[i],\r\n      t;\r\n    if (item == null || item === true || item === false) ; else if ((t = typeof item) === \"object\" && item.nodeType) {\r\n      normalized.push(item);\r\n    } else if (Array.isArray(item)) {\r\n      dynamic = normalizeIncomingArray(normalized, item, prev) || dynamic;\r\n    } else if (t === \"function\") {\r\n      if (unwrap) {\r\n        while (typeof item === \"function\") item = item();\r\n        dynamic = normalizeIncomingArray(normalized, Array.isArray(item) ? item : [item], Array.isArray(prev) ? prev : [prev]) || dynamic;\r\n      } else {\r\n        normalized.push(item);\r\n        dynamic = true;\r\n      }\r\n    } else {\r\n      const value = String(item);\r\n      if (prev && prev.nodeType === 3 && prev.data === value) normalized.push(prev);else normalized.push(document.createTextNode(value));\r\n    }\r\n  }\r\n  return dynamic;\r\n}\r\nfunction appendNodes(parent, array, marker = null) {\r\n  for (let i = 0, len = array.length; i < len; i++) parent.insertBefore(array[i], marker);\r\n}\r\nfunction cleanChildren(parent, current, marker, replacement) {\r\n  if (marker === undefined) return parent.textContent = \"\";\r\n  const node = replacement || document.createTextNode(\"\");\r\n  if (current.length) {\r\n    let inserted = false;\r\n    for (let i = current.length - 1; i >= 0; i--) {\r\n      const el = current[i];\r\n      if (node !== el) {\r\n        const isParent = el.parentNode === parent;\r\n        if (!inserted && !i) isParent ? parent.replaceChild(node, el) : parent.insertBefore(node, marker);else isParent && el.remove();\r\n      } else inserted = true;\r\n    }\r\n  } else parent.insertBefore(node, marker);\r\n  return [node];\r\n}\r\nfunction gatherHydratable(element, root) {\r\n  const templates = element.querySelectorAll(`*[data-hk]`);\r\n  for (let i = 0; i < templates.length; i++) {\r\n    const node = templates[i];\r\n    const key = node.getAttribute(\"data-hk\");\r\n    if ((!root || key.startsWith(root)) && !sharedConfig.registry.has(key)) sharedConfig.registry.set(key, node);\r\n  }\r\n}\r\nfunction getHydrationKey() {\r\n  const hydrate = sharedConfig.context;\r\n  return `${hydrate.id}${hydrate.count++}`;\r\n}\r\nfunction NoHydration(props) {\r\n  return sharedConfig.context ? undefined : props.children;\r\n}\r\nfunction Hydration(props) {\r\n  return props.children;\r\n}\r\nfunction voidFn() {}\r\n\r\nfunction throwInBrowser(func) {\r\n  const err = new Error(`${func.name} is not supported in the browser, returning undefined`);\r\n  console.error(err);\r\n}\r\nfunction renderToString(fn, options) {\r\n  throwInBrowser(renderToString);\r\n}\r\nfunction renderToStringAsync(fn, options) {\r\n  throwInBrowser(renderToStringAsync);\r\n}\r\nfunction renderToStream(fn, options) {\r\n  throwInBrowser(renderToStream);\r\n}\r\nfunction ssr(template, ...nodes) {}\r\nfunction ssrElement(name, props, children, needsId) {}\r\nfunction ssrClassList(value) {}\r\nfunction ssrStyle(value) {}\r\nfunction ssrAttribute(key, value) {}\r\nfunction ssrHydrationKey() {}\r\nfunction resolveSSRNode(node) {}\r\nfunction escape(html) {}\r\nfunction ssrSpread(props, isSVG, skipChildren) {}\r\n\r\nconst isServer = false;\r\nconst isDev = false;\r\nconst SVG_NAMESPACE = \"http://www.w3.org/2000/svg\";\r\nfunction createElement(tagName, isSVG = false) {\r\n  return isSVG ? document.createElementNS(SVG_NAMESPACE, tagName) : document.createElement(tagName);\r\n}\r\nconst hydrate = (...args) => {\r\n  enableHydration();\r\n  return hydrate$1(...args);\r\n};\r\nfunction Portal(props) {\r\n  const {\r\n      useShadow\r\n    } = props,\r\n    marker = document.createTextNode(\"\"),\r\n    mount = () => props.mount || document.body,\r\n    owner = getOwner();\r\n  let content;\r\n  let hydrating = !!sharedConfig.context;\r\n  createEffect(() => {\r\n    if (hydrating) getOwner().user = hydrating = false;\r\n    content || (content = runWithOwner(owner, () => createMemo(() => props.children)));\r\n    const el = mount();\r\n    if (el instanceof HTMLHeadElement) {\r\n      const [clean, setClean] = createSignal(false);\r\n      const cleanup = () => setClean(true);\r\n      createRoot(dispose => insert(el, () => !clean() ? content() : dispose(), null));\r\n      onCleanup(cleanup);\r\n    } else {\r\n      const container = createElement(props.isSVG ? \"g\" : \"div\", props.isSVG),\r\n        renderRoot = useShadow && container.attachShadow ? container.attachShadow({\r\n          mode: \"open\"\r\n        }) : container;\r\n      Object.defineProperty(container, \"_$host\", {\r\n        get() {\r\n          return marker.parentNode;\r\n        },\r\n        configurable: true\r\n      });\r\n      insert(renderRoot, content);\r\n      el.appendChild(container);\r\n      props.ref && props.ref(container);\r\n      onCleanup(() => el.removeChild(container));\r\n    }\r\n  }, undefined, {\r\n    render: !hydrating\r\n  });\r\n  return marker;\r\n}\r\nfunction Dynamic(props) {\r\n  const [p, others] = splitProps(props, [\"component\"]);\r\n  const cached = createMemo(() => p.component);\r\n  return createMemo(() => {\r\n    const component = cached();\r\n    switch (typeof component) {\r\n      case \"function\":\r\n        return untrack(() => component(others));\r\n      case \"string\":\r\n        const isSvg = SVGElements.has(component);\r\n        const el = sharedConfig.context ? getNextElement() : createElement(component, isSvg);\r\n        spread(el, others, isSvg);\r\n        return el;\r\n    }\r\n  });\r\n}\r\n\r\nexport { Aliases, voidFn as Assets, ChildProperties, DOMElements, DelegatedEvents, Dynamic, Hydration, voidFn as HydrationScript, NoHydration, Portal, Properties, SVGElements, SVGNamespace, addEventListener, assign, classList, className, clearDelegatedEvents, delegateEvents, dynamicProperty, escape, voidFn as generateHydrationScript, voidFn as getAssets, getHydrationKey, getNextElement, getNextMarker, getNextMatch, getPropAlias, hydrate, innerHTML, insert, isDev, isServer, render, renderToStream, renderToString, renderToStringAsync, resolveSSRNode, runHydrationEvents, setAttribute, setAttributeNS, spread, ssr, ssrAttribute, ssrClassList, ssrElement, ssrHydrationKey, ssrSpread, ssrStyle, style, template, use, voidFn as useAssets };\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport ripple from '../ripple';\r\nimport animationIntersector from '../animationIntersector';\r\nimport appNavigationController, {NavigationItem} from '../appNavigationController';\r\nimport {i18n, LangPackKey, _i18n} from '../../lib/langPack';\r\nimport findUpClassName from '../../helpers/dom/findUpClassName';\r\nimport blurActiveElement from '../../helpers/dom/blurActiveElement';\r\nimport ListenerSetter from '../../helpers/listenerSetter';\r\nimport {attachClickEvent, simulateClickEvent} from '../../helpers/dom/clickEvent';\r\nimport isSendShortcutPressed from '../../helpers/dom/isSendShortcutPressed';\r\nimport cancelEvent from '../../helpers/dom/cancelEvent';\r\nimport EventListenerBase, {EventListenerListeners} from '../../helpers/eventListenerBase';\r\nimport {addFullScreenListener, getFullScreenElement} from '../../helpers/dom/fullScreen';\r\nimport indexOfAndSplice from '../../helpers/array/indexOfAndSplice';\r\nimport {AppManagers} from '../../lib/appManagers/managers';\r\nimport overlayCounter from '../../helpers/overlayCounter';\r\nimport Scrollable from '../scrollable';\r\nimport {getMiddleware, MiddlewareHelper} from '../../helpers/middleware';\r\nimport ButtonIcon from '../buttonIcon';\r\nimport Icon from '../icon';\r\nimport toggleDisability from '../../helpers/dom/toggleDisability';\r\nimport {JSX} from 'solid-js';\r\nimport {render} from 'solid-js/web';\r\n\r\nexport type PopupButton = {\r\n  text?: HTMLElement | DocumentFragment | Text,\r\n  callback?: (e: MouseEvent) => void | MaybePromise<boolean>,\r\n  langKey?: LangPackKey,\r\n  langArgs?: any[],\r\n  isDanger?: boolean,\r\n  isCancel?: boolean,\r\n  element?: HTMLButtonElement,\r\n  noRipple?: boolean,\r\n  iconLeft?: Icon,\r\n  iconRight?: Icon\r\n};\r\n\r\nexport type PopupOptions = Partial<{\r\n  closable: boolean,\r\n  onBackClick: () => void | false,\r\n  isConfirmationNeededOnClose: () => void | boolean | Promise<any>, // should return boolean instantly or `Promise` from `confirmationPopup`\r\n  overlayClosable: boolean,\r\n  withConfirm: LangPackKey | boolean,\r\n  body: boolean,\r\n  footer: boolean,\r\n  confirmShortcutIsSendShortcut: boolean,\r\n  withoutOverlay: boolean,\r\n  scrollable: boolean,\r\n  buttons: Array<PopupButton>,\r\n  title: boolean | LangPackKey | DocumentFragment | HTMLElement,\r\n  floatingHeader: boolean,\r\n  withFooterConfirm: boolean\r\n}>;\r\n\r\nexport interface PopupElementConstructable<T extends PopupElement = any> {\r\n  new(...args: any[]): T;\r\n}\r\n\r\nconst DEFAULT_APPEND_TO = document.body;\r\nlet appendPopupTo = DEFAULT_APPEND_TO;\r\n\r\nconst onFullScreenChange = () => {\r\n  appendPopupTo = getFullScreenElement() || DEFAULT_APPEND_TO;\r\n  PopupElement.reAppend();\r\n};\r\n\r\naddFullScreenListener(DEFAULT_APPEND_TO, onFullScreenChange);\r\n\r\ntype PopupListeners = {\r\n  close: () => void,\r\n  closeAfterTimeout: () => void\r\n};\r\n\r\nexport default class PopupElement<T extends EventListenerListeners = {}> extends EventListenerBase<PopupListeners & T> {\r\n  private static POPUPS: PopupElement<any>[] = [];\r\n  public static MANAGERS: AppManagers;\r\n\r\n  protected element = document.createElement('div');\r\n  protected container = document.createElement('div');\r\n  protected header = document.createElement('div');\r\n  protected title = document.createElement('div');\r\n  protected footer: HTMLElement;\r\n  protected btnClose: HTMLElement;\r\n  protected btnCloseAnimatedIcon: HTMLElement;\r\n  protected btnConfirm: HTMLButtonElement;\r\n  protected body: HTMLElement;\r\n  protected buttonsEl: HTMLElement;\r\n\r\n  protected isConfirmationNeededOnClose: PopupOptions['isConfirmationNeededOnClose'];\r\n\r\n  protected navigationItem: NavigationItem;\r\n\r\n  protected listenerSetter: ListenerSetter;\r\n\r\n  protected confirmShortcutIsSendShortcut: boolean;\r\n  protected btnConfirmOnEnter: HTMLElement;\r\n\r\n  protected withoutOverlay: boolean;\r\n\r\n  protected managers: AppManagers;\r\n\r\n  protected scrollable: Scrollable;\r\n\r\n  protected buttons: Array<PopupButton>;\r\n\r\n  protected middlewareHelper: MiddlewareHelper;\r\n  protected destroyed: boolean;\r\n\r\n  protected night: boolean;\r\n\r\n  constructor(className: string, options: PopupOptions = {}) {\r\n    super(false);\r\n    this.element.classList.add('popup');\r\n    this.element.className = 'popup' + (className ? ' ' + className : '');\r\n    this.container.classList.add('popup-container', 'z-depth-1');\r\n\r\n    if(overlayCounter.isDarkOverlayActive) {\r\n      this.night = true;\r\n      this.element.classList.add('night');\r\n    }\r\n\r\n    this.header.classList.add('popup-header');\r\n\r\n    if(options.title) {\r\n      this.title.classList.add('popup-title');\r\n      if(typeof(options.title) === 'string') {\r\n        _i18n(this.title, options.title);\r\n      } else if(typeof(options.title) !== 'boolean') {\r\n        this.title.append(options.title);\r\n      }\r\n\r\n      this.header.append(this.title);\r\n    }\r\n\r\n    this.isConfirmationNeededOnClose = options.isConfirmationNeededOnClose;\r\n    this.middlewareHelper = getMiddleware();\r\n    this.listenerSetter = new ListenerSetter();\r\n    this.managers = PopupElement.MANAGERS;\r\n\r\n    this.confirmShortcutIsSendShortcut = options.confirmShortcutIsSendShortcut;\r\n\r\n    if(options.closable) {\r\n      this.btnClose = ButtonIcon('', {noRipple: true});\r\n      this.btnClose.classList.add('popup-close');\r\n      // ripple(this.closeBtn);\r\n      this.header.prepend(this.btnClose);\r\n\r\n      if(options.onBackClick) {\r\n        this.btnCloseAnimatedIcon = document.createElement('div');\r\n        this.btnCloseAnimatedIcon.classList.add('animated-close-icon');\r\n        this.btnClose.append(this.btnCloseAnimatedIcon);\r\n      } else {\r\n        this.btnClose.append(Icon('close'));\r\n      }\r\n\r\n      attachClickEvent(this.btnClose, () => {\r\n        if(options.onBackClick && this.btnCloseAnimatedIcon.classList.contains('state-back')) {\r\n          if(options.onBackClick() !== false) {\r\n            this.btnCloseAnimatedIcon.classList.remove('state-back');\r\n          }\r\n        } else {\r\n          this.hide();\r\n        }\r\n      }, {listenerSetter: this.listenerSetter});\r\n    }\r\n\r\n    this.withoutOverlay = options.withoutOverlay;\r\n    if(this.withoutOverlay) {\r\n      this.element.classList.add('no-overlay');\r\n    }\r\n\r\n    if(options.overlayClosable) {\r\n      attachClickEvent(this.element, (e: MouseEvent) => {\r\n        if(findUpClassName(e.target, 'popup-container') || !(e.target as HTMLElement).isConnected) {\r\n          return;\r\n        }\r\n\r\n        this.hide();\r\n      }, {listenerSetter: this.listenerSetter});\r\n    }\r\n\r\n    if(options.withConfirm) {\r\n      this.btnConfirm = document.createElement('button');\r\n      this.btnConfirm.classList.add('btn-primary', 'btn-color-primary');\r\n      if(options.withConfirm !== true) {\r\n        this.btnConfirm.append(i18n(options.withConfirm));\r\n      }\r\n      this.header.append(this.btnConfirm);\r\n      // ripple(this.btnConfirm);\r\n    }\r\n\r\n    this.container.append(this.header);\r\n    if(options.body) {\r\n      this.body = document.createElement('div');\r\n      this.body.classList.add('popup-body');\r\n      this.container.append(this.body);\r\n    }\r\n\r\n    if(options.scrollable) {\r\n      const scrollable = this.scrollable = new Scrollable(this.body);\r\n      this.attachScrollableListeners();\r\n\r\n      if(options.floatingHeader) {\r\n        this.attachScrollableListeners(this.header);\r\n        const background = document.createElement('div');\r\n        background.classList.add('popup-header-background');\r\n        this.header.prepend(background);\r\n        this.header.classList.add('is-floating');\r\n      }\r\n\r\n      if(!this.body) {\r\n        this.header.after(scrollable.container);\r\n      }\r\n    }\r\n\r\n    if(options.footer) {\r\n      this.footer = document.createElement('div');\r\n      this.footer.classList.add('popup-footer');\r\n      (this.body || this.container).append(this.footer);\r\n\r\n      if(options.withFooterConfirm) {\r\n        this.footer.append(this.btnConfirm);\r\n      }\r\n    }\r\n\r\n    this.btnConfirmOnEnter = this.btnConfirm;\r\n    this.setButtons(options.buttons);\r\n\r\n    this.element.append(this.container);\r\n\r\n    PopupElement.POPUPS.push(this);\r\n  }\r\n\r\n  protected setButtons(buttons: PopupButton[]) {\r\n    this.buttons = buttons;\r\n    if(this.buttonsEl) {\r\n      this.buttonsEl.remove();\r\n      this.buttonsEl = undefined;\r\n    }\r\n\r\n    if(!buttons?.length) {\r\n      return;\r\n    }\r\n\r\n    const buttonsDiv = this.buttonsEl = document.createElement('div');\r\n    buttonsDiv.classList.add('popup-buttons');\r\n\r\n    const buttonsElements = buttons.map((b) => {\r\n      const button = document.createElement('button');\r\n      button.className = 'popup-button btn' + (b.isDanger ? ' danger' : ' primary');\r\n\r\n      if(!b.noRipple) {\r\n        ripple(button);\r\n      }\r\n\r\n      if(b.text) {\r\n        button.append(b.text);\r\n      } else if(b.langKey) {\r\n        button.append(i18n(b.langKey, b.langArgs));\r\n      }\r\n\r\n      if(b.iconLeft || b.iconRight) {\r\n        const i = Icon(b.iconLeft || b.iconRight, 'popup-button-icon', b.iconLeft ? 'left' : 'right');\r\n        button.classList.add('with-icon');\r\n        if(b.iconLeft) button.prepend(i);\r\n        else button.append(i);\r\n      }\r\n\r\n      attachClickEvent(button, async(e) => {\r\n        let result = b.callback?.(e);\r\n        if(result !== undefined && result instanceof Promise) {\r\n          const toggle = toggleDisability([b.element], true);\r\n          try {\r\n            result = await result;\r\n          } catch(err) {\r\n            result = false;\r\n          }\r\n\r\n          if(result === false) {\r\n            toggle();\r\n          }\r\n        }\r\n\r\n        if(result === false) {\r\n          return;\r\n        }\r\n\r\n        this.hide();\r\n      }, {listenerSetter: this.listenerSetter});\r\n\r\n      return b.element = button;\r\n    });\r\n\r\n    if(!this.btnConfirmOnEnter && buttons.length === 2) {\r\n      const button = buttons.find((button) => !button.isCancel);\r\n      if(button) {\r\n        this.btnConfirmOnEnter = button.element;\r\n      }\r\n    }\r\n\r\n    if(buttons.length >= 3) {\r\n      buttonsDiv.classList.add('is-vertical-layout');\r\n    }\r\n\r\n    buttonsDiv.append(...buttonsElements);\r\n    this.container.append(buttonsDiv);\r\n  }\r\n\r\n  protected attachScrollableListeners(setClassOn?: HTMLElement) {\r\n    return this.scrollable.attachBorderListeners(setClassOn);\r\n  }\r\n\r\n  protected onContentUpdate() {\r\n    this.scrollable?.onAdditionalScroll?.();\r\n  }\r\n\r\n  public show() {\r\n    this.navigationItem = {\r\n      type: 'popup',\r\n      onPop: () => {\r\n        if(this.isConfirmationNeededOnClose) {\r\n          const result = this.isConfirmationNeededOnClose();\r\n          if(result) {\r\n            Promise.resolve(result).then(() => {\r\n              this.destroy();\r\n            });\r\n\r\n            return false;\r\n          }\r\n        }\r\n\r\n        return this.destroy();\r\n      }\r\n    };\r\n\r\n    appNavigationController.pushItem(this.navigationItem);\r\n\r\n    blurActiveElement(); // * hide mobile keyboard\r\n    appendPopupTo.append(this.element);\r\n    void this.element.offsetWidth; // reflow\r\n    this.element.classList.add('active');\r\n\r\n    this.onContentUpdate();\r\n\r\n    if(!this.withoutOverlay) {\r\n      overlayCounter.isOverlayActive = true;\r\n      animationIntersector.checkAnimations2(true);\r\n    }\r\n\r\n    // cannot add event instantly because keydown propagation will fire it\r\n    // if(this.btnConfirmOnEnter) {\r\n    setTimeout(() => {\r\n      if(!this.element.classList.contains('active')) {\r\n        return;\r\n      }\r\n\r\n      this.listenerSetter.add(document.body)('keydown', (e) => {\r\n        if(!this.btnConfirmOnEnter ||\r\n          (this.btnConfirmOnEnter as HTMLButtonElement).disabled ||\r\n          PopupElement.POPUPS[PopupElement.POPUPS.length - 1] !== this) {\r\n          return;\r\n        }\r\n\r\n        if(this.confirmShortcutIsSendShortcut ? isSendShortcutPressed(e) : e.key === 'Enter') {\r\n          simulateClickEvent(this.btnConfirmOnEnter);\r\n          cancelEvent(e);\r\n        }\r\n      });\r\n    }, 0);\r\n    // }\r\n  }\r\n\r\n  public hide() {\r\n    if(this.destroyed || !this.navigationItem) {\r\n      return;\r\n    }\r\n\r\n    appNavigationController.backByItem(this.navigationItem);\r\n  }\r\n\r\n  public hideWithCallback(callback: () => void) {\r\n    this.addEventListener('closeAfterTimeout', callback as any);\r\n    this.hide();\r\n  }\r\n\r\n  public forceHide() {\r\n    return this.destroy();\r\n  }\r\n\r\n  protected destroy() {\r\n    if(this.destroyed) {\r\n      return;\r\n    }\r\n\r\n    this.destroyed = true;\r\n    this.dispatchEvent<PopupListeners>('close');\r\n    this.element.classList.add('hiding');\r\n    this.element.classList.remove('active');\r\n    this.listenerSetter.removeAll();\r\n    this.middlewareHelper.destroy();\r\n\r\n    if(!this.withoutOverlay) {\r\n      overlayCounter.isOverlayActive = false;\r\n    }\r\n\r\n    appNavigationController.removeItem(this.navigationItem);\r\n    this.navigationItem = undefined;\r\n\r\n    indexOfAndSplice(PopupElement.POPUPS, this);\r\n\r\n    // ! calm\r\n    onFullScreenChange();\r\n\r\n    setTimeout(() => {\r\n      this.element.remove();\r\n      this.dispatchEvent<PopupListeners>('closeAfterTimeout');\r\n      this.cleanup();\r\n      this.scrollable?.destroy();\r\n\r\n      if(!this.withoutOverlay) {\r\n        animationIntersector.checkAnimations2(false);\r\n      }\r\n    }, 250);\r\n  }\r\n\r\n  protected appendSolid(callback: () => JSX.Element) {\r\n    const div = document.createElement('div');\r\n    (this.scrollable || this.body).prepend(div);\r\n    const dispose = render(callback, div);\r\n    this.addEventListener('closeAfterTimeout', dispose as any);\r\n  }\r\n\r\n  public static reAppend() {\r\n    this.POPUPS.forEach((popup) => {\r\n      const {element, container} = popup;\r\n      const parentElement = element.parentElement;\r\n      if(parentElement && parentElement !== appendPopupTo && appendPopupTo !== container) {\r\n        appendPopupTo.append(element);\r\n      }\r\n    });\r\n  }\r\n\r\n  public static getPopups<T extends PopupElement>(popupConstructor: PopupElementConstructable<T>) {\r\n    return this.POPUPS.filter((element) => element instanceof popupConstructor) as T[];\r\n  }\r\n\r\n  public static createPopup<T extends /* PopupElement */any, A extends Array<any>>(ctor: {new(...args: A): T}, ...args: A) {\r\n    const popup = new ctor(...args);\r\n    return popup;\r\n  }\r\n}\r\n\r\nexport const addCancelButton = (buttons: PopupButton[]) => {\r\n  const button = buttons.find((b) => b.isCancel);\r\n  if(!button) {\r\n    buttons.push({\r\n      langKey: 'Cancel',\r\n      isCancel: true\r\n    });\r\n  }\r\n\r\n  return buttons;\r\n};\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nfunction resizeableImage(originalImage: HTMLImageElement, canvas?: HTMLCanvasElement) {\r\n  let cropComponent: HTMLDivElement,\r\n    container: HTMLDivElement,\r\n    cropImage: HTMLImageElement,\r\n    cropLeft = 0,\r\n    cropTop = 0,\r\n    cropWidth = 0,\r\n    cropHeight = 0,\r\n    scaledRatio = 0;\r\n\r\n  const keyZoomValue = 4.0;\r\n  const event_state: Partial<{\r\n    mouse_x: number,\r\n    mouse_y: number,\r\n    container_width: number,\r\n    container_height: number,\r\n    container_left: number,\r\n    container_top: number\r\n  }> = {};\r\n  const MINWIDTH = 50,\r\n    MINHEIGHT = 50,\r\n    CROPWIDTH = 200,\r\n    CROPHEIGHT = 200;\r\n\r\n  if(originalImage.complete) init();\r\n  else originalImage.onload = init;\r\n\r\n  function removeHandlers() {\r\n    container.removeEventListener('mousedown', startMoving);\r\n    container.removeEventListener('touchstart', startMoving);\r\n    container.removeEventListener('wheel', resizing);\r\n\r\n    document.removeEventListener('mouseup', endMoving);\r\n    document.removeEventListener('touchend', endMoving);\r\n    document.removeEventListener('mousemove', moving);\r\n    document.removeEventListener('touchmove', moving);\r\n    document.removeEventListener('keypress', keyHandler);\r\n\r\n    cropComponent.remove();\r\n    container.remove();\r\n    cropImage.remove();\r\n  }\r\n\r\n  function addHandlers() {\r\n    container.addEventListener('mousedown', startMoving, false);\r\n    container.addEventListener('touchstart', startMoving, false);\r\n    container.addEventListener('wheel', resizing, false);\r\n\r\n    document.addEventListener('keypress', keyHandler, false);\r\n    // document.querySelector('.btn-crop').addEventListener('click', openCropCanvasImg);\r\n  }\r\n\r\n  function init() {\r\n    originalImage.classList.add('crop-blur');\r\n    originalImage.draggable = false;\r\n\r\n    cropImage = new Image();\r\n    cropImage.src = originalImage.src;\r\n    cropImage.draggable = false;\r\n    cropImage.classList.add('crop-overlay-image');\r\n\r\n    if(!canvas) {\r\n      canvas = document.createElement('canvas');\r\n    }\r\n\r\n    cropComponent = document.createElement('div');\r\n    cropComponent.classList.add('crop-component');\r\n\r\n    container = document.createElement('div');\r\n    container.classList.add('crop-overlay');\r\n\r\n    const overlayColor = document.createElement('div');\r\n    overlayColor.classList.add('crop-overlay-color');\r\n\r\n    cropComponent.appendChild(container);\r\n    const wrapper = originalImage.parentNode as HTMLElement;\r\n    wrapper.appendChild(cropComponent);\r\n    cropComponent.appendChild(cropImage);\r\n    cropComponent.appendChild(originalImage);\r\n    cropComponent.appendChild(overlayColor);\r\n    container.appendChild(cropImage);\r\n\r\n    cropImage.style.maxWidth = originalImage.width + 'px';\r\n\r\n    scaledRatio = originalImage.naturalWidth / originalImage.offsetWidth;\r\n\r\n    const left = originalImage.offsetWidth / 2 - CROPWIDTH / 2;\r\n    const top = originalImage.offsetHeight / 2 - CROPHEIGHT / 2;\r\n\r\n    updateCropSize(CROPWIDTH, CROPHEIGHT);\r\n    updateCropImage(left, top);\r\n    updateContainer(left, top);\r\n    addHandlers();\r\n    // crop();\r\n  }\r\n\r\n  function updateCropSize(width: number, height: number) {\r\n    cropWidth = width * scaledRatio;\r\n    cropHeight = height * scaledRatio;\r\n\r\n    container.style.width = width + 'px';\r\n    container.style.height = height + 'px';\r\n  }\r\n\r\n  function updateCropImage(left: number, top: number) {\r\n    cropTop = top * scaledRatio;\r\n    cropLeft = left * scaledRatio;\r\n\r\n    cropImage.style.top = -top + 'px';\r\n    cropImage.style.left = -left + 'px';\r\n  }\r\n\r\n  function updateContainer(left: number, top: number) {\r\n    container.style.top = top + 'px';\r\n    container.style.left = left + 'px';\r\n  }\r\n\r\n  // Save the initial event details and container state\r\n  function saveEventState(e: any) {\r\n    event_state.container_width = container.offsetWidth;\r\n    event_state.container_height = container.offsetHeight;\r\n\r\n    event_state.container_left = container.offsetLeft;\r\n    event_state.container_top = container.offsetTop;\r\n\r\n    event_state.mouse_x = (e.clientX || e.pageX || e.touches && e.touches[0].clientX) + window.scrollX;\r\n    event_state.mouse_y = (e.clientY || e.pageY || e.touches && e.touches[0].clientY) + window.scrollY;\r\n  }\r\n\r\n  function imgZoom(zoom: number) {\r\n    zoom = zoom * Math.PI * 2\r\n    const newWidth = Math.floor(container.clientWidth + zoom),\r\n      newHeight = Math.floor(container.clientHeight + zoom),\r\n      w = cropImage.clientWidth,\r\n      h = cropImage.clientHeight;\r\n    let left: number,\r\n      top: number;\r\n\r\n    if(newWidth < MINWIDTH) {\r\n      return;\r\n    } else if(newWidth > w) {\r\n      return;\r\n    }\r\n\r\n    left = container.offsetLeft - (zoom / 2);\r\n    top = container.offsetTop - (zoom / 2);\r\n    const right = left + newWidth;\r\n    const bottom = top + newHeight;\r\n\r\n    if(left < 0) left = 0;\r\n    if(top < 0) top = 0;\r\n\r\n    if(right > w) return;\r\n    if(bottom > h) return;\r\n\r\n    updateCropSize(newWidth, newWidth);\r\n    updateCropImage(left, top);\r\n    updateContainer(left, top);\r\n    // crop();\r\n  }\r\n\r\n  function keyHandler(e: KeyboardEvent) {\r\n    e.preventDefault();\r\n\r\n    switch(String.fromCharCode(e.charCode)) {\r\n      case '+':\r\n        imgZoom(keyZoomValue);\r\n        break;\r\n      case '-':\r\n        imgZoom(-keyZoomValue);\r\n        break;\r\n    }\r\n  }\r\n\r\n  function resizing(e: any) {\r\n    e.preventDefault();\r\n    imgZoom(e.deltaY > 0 ? 1 : -1);\r\n  }\r\n\r\n  function startMoving(e: MouseEvent | TouchEvent) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n\r\n    saveEventState(e);\r\n\r\n    document.addEventListener('mousemove', moving);\r\n    document.addEventListener('touchmove', moving);\r\n    document.addEventListener('mouseup', endMoving);\r\n    document.addEventListener('touchend', endMoving);\r\n  }\r\n\r\n  function endMoving(e: MouseEvent | TouchEvent) {\r\n    e.preventDefault();\r\n\r\n    document.removeEventListener('mouseup', endMoving);\r\n    document.removeEventListener('touchend', endMoving);\r\n    document.removeEventListener('mousemove', moving);\r\n    document.removeEventListener('touchmove', moving);\r\n  }\r\n\r\n  function moving(e: any) {\r\n    const currentTouch = {x: 0, y: 0};\r\n\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n\r\n    currentTouch.x = e.pageX || e.touches && e.touches[0].pageX;\r\n    currentTouch.y = e.pageY || e.touches && e.touches[0].pageY;\r\n\r\n    let left = currentTouch.x - (event_state.mouse_x - event_state.container_left);\r\n    let top = currentTouch.y - (event_state.mouse_y - event_state.container_top);\r\n    const w = container.offsetWidth;\r\n    const h = container.offsetHeight;\r\n\r\n    if(left < 0) left = 0;\r\n    else if(left > cropImage.offsetWidth - w) left = cropImage.offsetWidth - w;\r\n\r\n    if(top < 0) top = 0;\r\n    else if(top > cropImage.offsetHeight - h) top = cropImage.offsetHeight - h;\r\n\r\n    updateCropImage(left, top);\r\n    updateContainer(left, top);\r\n    // crop();\r\n  }\r\n\r\n  function crop() {\r\n    canvas.width = cropWidth;\r\n    canvas.height = cropHeight;\r\n\r\n    const ctx = canvas.getContext('2d');\r\n    ctx.drawImage(originalImage,\r\n      cropLeft, cropTop,\r\n      cropWidth, cropHeight,\r\n      0, 0,\r\n      cropWidth, cropHeight\r\n    );\r\n  }\r\n\r\n  return {crop, removeHandlers};\r\n}\r\n\r\nexport default resizeableImage;\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\n// import { IS_WEB_WORKER } from \"../context\";\r\n\r\n// const id = IS_WEB_WORKER ? Math.random() * 0x1000 | 0 : 0;\r\nexport default function readBlobAs(blob: Blob, method: 'readAsText'): Promise<string>;\r\nexport default function readBlobAs(blob: Blob, method: 'readAsDataURL'): Promise<string>;\r\nexport default function readBlobAs(blob: Blob, method: 'readAsArrayBuffer'): Promise<ArrayBuffer>;\r\nexport default function readBlobAs(blob: Blob, method: 'readAsArrayBuffer' | 'readAsText' | 'readAsDataURL'): Promise<any> {\r\n  // const perf = performance.now();\r\n  return new Promise<any>((resolve) => {\r\n    const reader = new FileReader();\r\n    reader.addEventListener('loadend', (e) => {\r\n      // console.log(`readBlobAs [${id}] ${method} time ${performance.now() - perf}`);\r\n      resolve(e.target.result);\r\n    });\r\n    reader[method](blob);\r\n  });\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport readBlobAs from './readBlobAs';\r\n\r\nexport default function readBlobAsDataURL(blob: Blob) {\r\n  return readBlobAs(blob, 'readAsDataURL');\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport type {AppDownloadManager} from '../../lib/appManagers/appDownloadManager';\r\nimport resizeableImage from '../../lib/cropper';\r\nimport PopupElement from '.';\r\nimport {_i18n} from '../../lib/langPack';\r\nimport {attachClickEvent} from '../../helpers/dom/clickEvent';\r\nimport readBlobAsDataURL from '../../helpers/blob/readBlobAsDataURL';\r\nimport appDownloadManager from '../../lib/appManagers/appDownloadManager';\r\nimport Button from '../button';\r\n\r\nexport default class PopupAvatar extends PopupElement {\r\n  private cropContainer: HTMLElement;\r\n  private input: HTMLInputElement;\r\n  private h6: HTMLElement;\r\n\r\n  private image = new Image();\r\n\r\n  private canvas: HTMLCanvasElement;\r\n  private blob: Blob;\r\n  private cropper = {\r\n    crop: () => {},\r\n    removeHandlers: () => {}\r\n  };\r\n\r\n  private onCrop: (upload: () => ReturnType<AppDownloadManager['upload']>) => void;\r\n\r\n  constructor(options: Partial<{\r\n    isForum: boolean\r\n  }> = {}) {\r\n    super('popup-avatar', {closable: true});\r\n\r\n    this.h6 = document.createElement('h6');\r\n    _i18n(this.h6, 'Popup.Avatar.Title');\r\n\r\n    this.btnClose.classList.remove('btn-icon');\r\n\r\n    this.header.append(this.h6);\r\n\r\n    this.cropContainer = document.createElement('div');\r\n    this.cropContainer.classList.add('crop');\r\n    this.cropContainer.append(this.image);\r\n\r\n    if(options.isForum) {\r\n      this.cropContainer.classList.add('is-forum');\r\n    }\r\n\r\n    this.input = document.createElement('input');\r\n    this.input.type = 'file';\r\n    this.input.style.display = 'none';\r\n    this.listenerSetter.add(this.input)('change', (e: any) => {\r\n      const file = e.target.files[0];\r\n      if(!file) {\r\n        return;\r\n      }\r\n\r\n      readBlobAsDataURL(file).then((contents) => {\r\n        this.image = new Image();\r\n        this.cropContainer.append(this.image);\r\n        this.image.src = contents;\r\n\r\n        this.image.onload = () => {\r\n          /* let {w, h} = calcImageInBox(this.image.naturalWidth, this.image.naturalHeight, 460, 554);\r\n          cropContainer.style.width = w + 'px';\r\n          cropContainer.style.height = h + 'px'; */\r\n          this.show();\r\n\r\n          this.cropper = resizeableImage(this.image, this.canvas);\r\n          this.input.value = '';\r\n        };\r\n      });\r\n    }, false);\r\n\r\n    this.btnConfirm = Button(`btn-primary btn-color-primary btn-circle btn-crop btn-icon z-depth-1`, {noRipple: true, icon: 'check'});\r\n    attachClickEvent(this.btnConfirm, () => {\r\n      this.cropper.crop();\r\n      this.hide();\r\n\r\n      this.canvas.toBlob((blob) => {\r\n        this.blob = blob; // save blob to send after reg\r\n        this.darkenCanvas();\r\n        this.resolve();\r\n      }, 'image/jpeg', 1);\r\n    }, {listenerSetter: this.listenerSetter});\r\n\r\n    this.container.append(this.cropContainer, this.btnConfirm, this.input);\r\n\r\n    this.addEventListener('closeAfterTimeout', () => {\r\n      this.cropper.removeHandlers();\r\n      if(this.image) {\r\n        this.image.remove();\r\n      }\r\n    });\r\n  }\r\n\r\n  private resolve() {\r\n    this.onCrop(() => {\r\n      return appDownloadManager.upload(this.blob);\r\n    });\r\n  }\r\n\r\n  public open(postCanvas: HTMLCanvasElement, onCrop: PopupAvatar['onCrop']) {\r\n    this.canvas = postCanvas;\r\n    this.onCrop = onCrop;\r\n\r\n    this.input.click();\r\n  }\r\n\r\n  public darkenCanvas() {\r\n    const ctx = this.canvas.getContext('2d');\r\n    ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';\r\n    ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n  }\r\n}\r\n"],"names":["isSendShortcutPressed","e","IS_MOBILE","rootScope","secondaryKey","IS_APPLE","requestFullScreen","element","cancelFullScreen","addFullScreenListener","callback","listenerSetter","addListener","eventName","getFullScreenElement","isFullScreen","ButtonIcon","className","options","splitted","Button","booleans","Properties","ChildProperties","Aliases","PropAliases","getPropAlias","prop","tagName","a","DelegatedEvents","SVGElements","SVGNamespace","reconcileArrays","parentNode","b","bLength","aEnd","bEnd","aStart","bStart","after","map","node","i","index","sequence","t","$$EVENTS","render","code","init","disposer","createRoot","dispose","insert","template","html","isCE","isSVG","create","fn","untrack","delegateEvents","eventNames","document","l","name","eventHandler","setAttribute","value","setAttributeNS","namespace","addEventListener","handler","delegate","handlerFn","classList","prev","classKeys","prevKeys","len","key","toggleClassKey","classValue","style","nodeStyle","v","s","spread","props","skipChildren","prevProps","createRenderEffect","insertExpression","assign","use","arg","parent","accessor","marker","initial","current","skipRef","assignProp","toPropertyName","_","w","classNames","nameLen","isProp","isChildProp","propAlias","forceProp","h","ns","data","unwrapArray","multi","cleanChildren","array","currentArray","normalizeIncomingArray","appendNodes","normalized","unwrap","dynamic","item","replacement","inserted","el","isParent","SVG_NAMESPACE","createElement","Portal","useShadow","mount","owner","getOwner","content","hydrating","sharedConfig","createEffect","runWithOwner","createMemo","clean","setClean","createSignal","cleanup","onCleanup","container","renderRoot","Dynamic","p","others","splitProps","cached","component","isSvg","DEFAULT_APPEND_TO","appendPopupTo","onFullScreenChange","PopupElement","_PopupElement","EventListenerBase","overlayCounter","_i18n","getMiddleware","ListenerSetter","Icon","attachClickEvent","findUpClassName","i18n","scrollable","Scrollable","background","buttons","buttonsDiv","buttonsElements","button","ripple","result","toggle","toggleDisability","setClassOn","appNavigationController","blurActiveElement","animationIntersector","simulateClickEvent","cancelEvent","indexOfAndSplice","div","popup","parentElement","popupConstructor","ctor","args","addCancelButton","resizeableImage","originalImage","canvas","cropComponent","cropImage","cropLeft","cropTop","cropWidth","cropHeight","scaledRatio","keyZoomValue","event_state","MINWIDTH","CROPWIDTH","CROPHEIGHT","removeHandlers","startMoving","resizing","endMoving","moving","keyHandler","addHandlers","overlayColor","left","top","updateCropSize","updateCropImage","updateContainer","width","height","saveEventState","imgZoom","zoom","newWidth","newHeight","right","bottom","currentTouch","crop","readBlobAs","blob","method","resolve","reader","readBlobAsDataURL","PopupAvatar","file","contents","appDownloadManager","postCanvas","onCrop","ctx"],"mappings":"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"}